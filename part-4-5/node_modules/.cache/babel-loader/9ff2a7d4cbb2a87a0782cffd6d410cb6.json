{"ast":null,"code":"\"use strict\";\n\nvar _toArray = require(\"/home/thib/github/substrate-developer-hub/basic-dapp/part-4-5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toArray\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _util = require(\"@polkadot/util\"); // Copyright 2017-2019 @polkadot/api authors & contributors\n// This software may be modified and distributed under the terms\n// of the Apache-2.0 license. See the LICENSE file for details.\n\n\nclass Combinator {\n  constructor(fns, callback) {\n    this._allHasFired = false;\n    this._callback = void 0;\n    this._fired = [];\n    this._fns = [];\n    this._isActive = true;\n    this._results = [];\n    this._subscriptions = [];\n    this._callback = callback;\n    this._subscriptions = fns.map(async (input, index) => {\n      const _ref = Array.isArray(input) ? input : [input],\n            _ref2 = _toArray(_ref),\n            fn = _ref2[0],\n            args = _ref2.slice(1);\n\n      this._fired.push(false);\n\n      this._fns.push(fn); // @ts-ignore Not quite 100% how to have a variable number at the front here\n\n\n      return fn(...args, this.createCallback(index));\n    });\n  }\n\n  allHasFired() {\n    if (!this._allHasFired) {\n      this._allHasFired = this._fired.filter(hasFired => !hasFired).length === 0;\n    }\n\n    return this._allHasFired;\n  }\n\n  createCallback(index) {\n    return value => {\n      this._fired[index] = true;\n      this._results[index] = value;\n      this.triggerUpdate();\n    };\n  }\n\n  triggerUpdate() {\n    if (!this._isActive || !(0, _util.isFunction)(this._callback) || !this.allHasFired()) {\n      return;\n    }\n\n    try {\n      this._callback(this._results);\n    } catch (error) {// swallow, we don't want the handler to trip us up\n    }\n  }\n\n  unsubscribe() {\n    if (!this._isActive) {\n      return;\n    }\n\n    this._isActive = false;\n\n    this._subscriptions.forEach(async subscription => {\n      try {\n        const unsubscribe = await subscription;\n\n        if ((0, _util.isFunction)(unsubscribe)) {\n          unsubscribe();\n        }\n      } catch (error) {// ignore\n      }\n    });\n  }\n\n}\n\nexports.default = Combinator;","map":null,"metadata":{},"sourceType":"script"}