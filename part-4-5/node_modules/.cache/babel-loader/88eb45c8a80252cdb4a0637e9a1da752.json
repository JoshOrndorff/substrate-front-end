{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/home/thib/github/substrate-developer-hub/basic-dapp/part-4-5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _utilCrypto = require(\"@polkadot/util-crypto\"); // Copyright 2018 Paritytech via paritytech/oo7/polkadot-identicon\n// Copyright 2018 @polkadot/react-identicon authors & contributors\n// This software may be modified and distributed under the terms\n// of the Apache-2.0 license. See the LICENSE file for details.\n// This has been converted from the original version that can be found at\n//\n// https://github.com/paritytech/oo7/blob/251ba2b7c45503b68eab4320c270b5afa9bccb60/packages/polkadot-identicon/src/index.jsx\n//\n// Here we have done the following to convert the component -\n//   - Converted the code to TypeScript\n//   - Removed the oo7 dependencies (since not initialised properly, it makes calls to wrong endpoints)\n//   - Remove encoding functionality, these are catered for in the base\n//   - Remove copy functionality (this is catered from in the base components)\n//   - Split calculations into relevant functions\n//   - Move constants to file-level\n//   - Overall it is now just a static component, expecting an address as an input value\n\n\nconst blake2 = value => (0, _utilCrypto.blake2AsU8a)(value, 512);\n\nconst s = 64;\nconst c = s / 2;\nconst z = s / 64 * 5;\nconst zero = blake2(new Uint8Array(32));\nconst schema = {\n  target: {\n    freq: 1,\n    colors: [0, 28, 0, 0, 28, 0, 0, 28, 0, 0, 28, 0, 0, 28, 0, 0, 28, 0, 1]\n  },\n  cube: {\n    freq: 20,\n    colors: [0, 1, 3, 2, 4, 3, 0, 1, 3, 2, 4, 3, 0, 1, 3, 2, 4, 3, 5]\n  },\n  quazar: {\n    freq: 16,\n    colors: [1, 2, 3, 1, 2, 4, 5, 5, 4, 1, 2, 3, 1, 2, 4, 5, 5, 4, 0]\n  },\n  flower: {\n    freq: 32,\n    colors: [0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 3]\n  },\n  cyclic: {\n    freq: 32,\n    colors: [0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 6]\n  },\n  vmirror: {\n    freq: 128,\n    colors: [0, 1, 2, 3, 4, 5, 3, 4, 2, 0, 1, 6, 7, 8, 9, 7, 8, 6, 10]\n  },\n  hmirror: {\n    freq: 128,\n    colors: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 8, 6, 7, 5, 3, 4, 2, 11]\n  }\n};\n\nclass Identicon extends _react.default.PureComponent {\n  render() {\n    const _this$props = this.props,\n          address = _this$props.address,\n          className = _this$props.className,\n          size = _this$props.size,\n          style = _this$props.style;\n    const xy = this.getCircleXY();\n    const colors = this.getColors();\n    return _react.default.createElement(\"div\", {\n      className: \"container \".concat(className),\n      style: style\n    }, _react.default.createElement(\"svg\", {\n      id: address,\n      name: address,\n      width: size,\n      height: size,\n      viewBox: \"0 0 64 64\"\n    }, this.renderCircle(s / 2, s / 2, s / 2, '#eee', -1), xy.map((_ref, index) => {\n      let _ref2 = _slicedToArray(_ref, 2),\n          x = _ref2[0],\n          y = _ref2[1];\n\n      return this.renderCircle(x, y, z, colors[index], index);\n    })));\n  }\n\n  renderCircle(cx, cy, r, fill, key) {\n    return _react.default.createElement(\"circle\", {\n      key: key,\n      cx: cx,\n      cy: cy,\n      r: r,\n      fill: fill\n    });\n  }\n\n  getCircleXY() {\n    const _this$getRotation = this.getRotation(),\n          r = _this$getRotation.r,\n          ro2 = _this$getRotation.ro2,\n          r3o4 = _this$getRotation.r3o4,\n          ro4 = _this$getRotation.ro4,\n          rroot3o2 = _this$getRotation.rroot3o2,\n          rroot3o4 = _this$getRotation.rroot3o4;\n\n    return [[c, c - r], [c, c - ro2], [c - rroot3o4, c - r3o4], [c - rroot3o2, c - ro2], [c - rroot3o4, c - ro4], [c - rroot3o2, c], [c - rroot3o2, c + ro2], [c - rroot3o4, c + ro4], [c - rroot3o4, c + r3o4], [c, c + r], [c, c + ro2], [c + rroot3o4, c + r3o4], [c + rroot3o2, c + ro2], [c + rroot3o4, c + ro4], [c + rroot3o2, c], [c + rroot3o2, c - ro2], [c + rroot3o4, c - ro4], [c + rroot3o4, c - r3o4], [c, c]];\n  }\n\n  getRotation() {\n    const _this$props$sixPoint = this.props.sixPoint,\n          sixPoint = _this$props$sixPoint === void 0 ? false : _this$props$sixPoint;\n    const r = sixPoint ? s / 2 / 8 * 5 : s / 2 / 4 * 3;\n    const rroot3o2 = r * Math.sqrt(3) / 2;\n    const ro2 = r / 2;\n    const rroot3o4 = r * Math.sqrt(3) / 4;\n    const ro4 = r / 4;\n    const r3o4 = r * 3 / 4;\n    return {\n      r,\n      ro2,\n      r3o4,\n      ro4,\n      rroot3o2,\n      rroot3o4\n    };\n  }\n\n  getColors() {\n    const address = this.props.address;\n    const total = Object.keys(schema).map(k => schema[k].freq).reduce((a, b) => a + b);\n    const id = Array.from(blake2((0, _utilCrypto.decodeAddress)(address))).map((x, i) => (x + 256 - zero[i]) % 256);\n    const d = Math.floor((id[30] + id[31] * 256) % total);\n    const rot = id[28] % 6 * 3;\n    const sat = Math.floor(id[29] * 70 / 256 + 26) % 80 + 30;\n    const scheme = this.findScheme(d);\n    const palette = Array.from(id).map((x, i) => {\n      const b = (x + i % 28 * 58) % 256;\n\n      if (b === 0) {\n        return '#444';\n      } else if (b === 255) {\n        return 'transparent';\n      }\n\n      const h = Math.floor(b % 64 * 360 / 64);\n      const l = [53, 15, 35, 75][Math.floor(b / 64)];\n      return \"hsl(\".concat(h, \", \").concat(sat, \"%, \").concat(l, \"%)\");\n    });\n    return scheme.colors.map((_, i) => palette[scheme.colors[i < 18 ? (i + rot) % 18 : 18]]);\n  }\n\n  findScheme(d) {\n    let cum = 0;\n    const ks = Object.keys(schema);\n\n    for (const i in ks) {\n      cum += schema[ks[i]].freq;\n\n      if (d < cum) {\n        return schema[ks[i]];\n      }\n    }\n\n    throw new Error('Unable to find schema');\n  }\n\n}\n\nexports.default = Identicon;","map":null,"metadata":{},"sourceType":"script"}