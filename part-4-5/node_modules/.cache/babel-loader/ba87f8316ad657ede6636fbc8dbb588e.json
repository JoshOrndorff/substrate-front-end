{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _util = require(\"@polkadot/util\");\n\nvar _observable = _interopRequireDefault(require(\"../observable\")); // Copyright 2017-2019 @polkadot/ui-keyring authors & contributors\n// This software may be modified and distributed under the terms\n// of the Apache-2.0 license. See the LICENSE file for details.\n\n\nlet hasCalledInitOptions = false;\n\nconst sortByName = (a, b) => {\n  const valueA = a.option.name;\n  const valueB = b.option.name;\n  return valueA.localeCompare(valueB);\n};\n\nconst sortByCreated = (a, b) => {\n  const valueA = a.json.meta.whenCreated || 0;\n  const valueB = b.json.meta.whenCreated || 0;\n\n  if (valueA < valueB) {\n    return 1;\n  }\n\n  if (valueA > valueB) {\n    return -1;\n  }\n\n  return 0;\n};\n\nclass KeyringOption {\n  constructor() {\n    this.optionsSubject = new _rxjs.BehaviorSubject(this.emptyOptions());\n  }\n\n  createOptionHeader(name) {\n    return {\n      className: 'header disabled',\n      name,\n      key: \"header-\".concat(name.toLowerCase()),\n      text: name,\n      value: null\n    };\n  }\n\n  init(keyring) {\n    (0, _util.assert)(!hasCalledInitOptions, 'Unable to initialise options more than once');\n\n    _observable.default.subscribe(() => {\n      const options = this.emptyOptions();\n      this.addAccounts(keyring, options);\n      this.addAddresses(keyring, options);\n      this.addContracts(keyring, options);\n      options.address = this.linkItems({\n        Addresses: options.address,\n        Recent: options.recent\n      });\n      options.account = this.linkItems({\n        Accounts: options.account,\n        Development: options.testing\n      });\n      options.contract = this.linkItems({\n        Contracts: options.contract\n      });\n      options.all = [].concat(options.account, options.address);\n      options.allPlus = [].concat(options.account, options.address, options.contract);\n      this.optionsSubject.next(options);\n    });\n\n    hasCalledInitOptions = true;\n  }\n\n  linkItems(items) {\n    return Object.keys(items).reduce((result, header) => {\n      const options = items[header];\n      return result.concat(options.length ? [this.createOptionHeader(header)] : [], options);\n    }, []);\n  }\n\n  addAccounts(keyring, options) {\n    const available = keyring.accounts.subject.getValue();\n    Object.values(available).sort(sortByName).forEach(_ref => {\n      let _ref$json$meta$isTest = _ref.json.meta.isTesting,\n          isTesting = _ref$json$meta$isTest === void 0 ? false : _ref$json$meta$isTest,\n          option = _ref.option;\n\n      if (!isTesting) {\n        options.account.push(option);\n      } else {\n        options.testing.push(option);\n      }\n    });\n  }\n\n  addAddresses(keyring, options) {\n    const available = keyring.addresses.subject.getValue();\n    Object.values(available).filter(_ref2 => {\n      let json = _ref2.json;\n      return !!json.meta.isRecent;\n    }).sort(sortByCreated).forEach(_ref3 => {\n      let option = _ref3.option;\n      options.recent.push(option);\n    });\n    Object.values(available).filter(_ref4 => {\n      let json = _ref4.json;\n      return !json.meta.isRecent;\n    }).sort(sortByName).forEach(_ref5 => {\n      let option = _ref5.option;\n      options.address.push(option);\n    });\n  }\n\n  addContracts(keyring, options) {\n    const available = keyring.contracts.subject.getValue();\n    Object.values(available).sort(sortByName).forEach(_ref6 => {\n      let option = _ref6.option;\n      options.contract.push(option);\n    });\n  }\n\n  emptyOptions() {\n    return {\n      account: [],\n      address: [],\n      contract: [],\n      all: [],\n      allPlus: [],\n      recent: [],\n      testing: []\n    };\n  }\n\n}\n\nconst keyringOptionInstance = new KeyringOption();\nvar _default = keyringOptionInstance;\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}